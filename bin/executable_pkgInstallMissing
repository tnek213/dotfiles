#!/bin/bash

TRASH="/tmp"
DROPBOX="$HOME/Dropbox"

has() {
  command -v "$1" &>/dev/null
}

err() {
  echo "$@" 1>&2
}

if has pacman; then
  install() { sudo pacman --needed -S $@; }
  remove() { echo -n 'remove: ' ; sudo pacman --noconfirm -R $@; }

  install tree               # list directories in a a tree
  if [ -d /sys/class/backlight/intel_backlight ]; then
    remove xorg-xbacklight
    install acpilight        # has xbacklight that works using acpi
  fi
  install inkscape           # vector paint program
  install graphviz           # tool to create graphs from text descr
  install jq                 # handle json at the command line
  install xz                 # handle XZ and LZMA compressed files (for Flutter)
fi

if has paru; then
  install() { paru --needed -S $@; }
  remove() { echo -n 'remove: ' ; sudo paru --noconfirm -R $@; }

  install informant          # Arch linux news reader
  install kb                 # Terminal based knowledge mngmt tool
  KBDIR="$HOME/.kb"
  if [ -f "$KBDIR"  ] && [ ! -L "$KBDIR" ] && [ -d "$DROPBOX" ]; then
    err "$KBDIR exists but is not a symlink! Moving to $TRASH"
    mv -v "$KBDIR" "$TRASH"
    if [ -d "$DROPBOX/.kb" ]; then
      ln -sv "$DROPBOX/.kb" "$KBDIR"
    else
      err "Missing $DROPBOX/.kb"
    fi
  fi
  install visual-studio-code-bin   # ide
  install nerd-fonts-fira-code     # nice complete font used in my polybar config etc
  install tealdeer                 # gives tl/dr for commands
  install todotxt                  # todo.txt, my favorite todo manager
  install krita                    # bitmap paint program
  install nerd-fonts-fira-code     # font, for programming
  install nerd-fonts-ibm-plex-mono # font, for programming
fi
